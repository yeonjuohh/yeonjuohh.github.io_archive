{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/isl/ch10/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Hado Log"}},"markdownRemark":{"id":"e24f9e4f-205c-5eaa-8ad5-4393a9b53a91","excerpt":"10. Unsupervised Learning Unsupervised learning 문제에서는 Y가 없다. 그렇기 때문에 unsupervised learning의 목적은 예측이 아니라 X의 흥미로운 특징을 발견하는 것이다. 예를 들어, unsupervised learning…","html":"<h1>10. Unsupervised Learning</h1>\n<ul>\n<li>Unsupervised learning 문제에서는 <em>Y</em>가 없다. 그렇기 때문에 unsupervised learning의 목적은 예측이 아니라 <em>X</em>의 흥미로운 특징을 발견하는 것이다.</li>\n<li>예를 들어, unsupervised learning은 “데이터를 시각화  수 있는 유익한 방법이 있을까?”, “데이터를 의미 있는 그룹으로 나눌 수 있을까?” 등과 같은 질문에 답을 하고 싶을 때 사용한다.</li>\n</ul>\n<h2>10.1 The Challenge of Unsupervised Learning</h2>\n<ul>\n<li>모델 선택부터 결과 분석까지 명확한 supervised learning과 달리 unsupervised learning은 누가 분석하느냐에 따라 결과가 달라질 가능성이 높아 어렵다고 여겨진다. 또한, 분석 결과가 잘 되었다고 객관적으로 평가하기가 힘들다.</li>\n<li>Unsupervised learning은 exploratory data analysis 단계에서 주로 사용되기도 한다.</li>\n</ul>\n<h2>10.2 Principal Components Analysis</h2>\n<ul>\n<li>Principal component analysis는 principal components을 이용해 데이터를 이해하는 방법이다. 고차원의 데이터를 시각화하고 싶을 때 많이 사용된다.</li>\n</ul>\n<h3>10.2.1 What Are Principal Components?</h3>\n<ul>\n<li>\n<p>고차원의 데이터를 시각화한다고 생각해 보자. 만약 p개의 <em>X</em>가 있다면 2차원 scatter plot를 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\">(</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>p</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\left ( \\begin{array}{c} p\\\\ 2 \\end{array} \\right )</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span></span></span>개 그려야 한다. 이는 비효율적일 뿐만 아니라 하나의 <em>X</em>는 전체 데이터가 가지고 있는 정보의 일부분만을 가지고 있기 때문에 그래프가 유익하지 않을 가능성이 많다.</p>\n</li>\n<li>\n<p>이런 상황에서는 데이터의 정보를 너무 많이 잃지 않는 선에서 데이터를 저차원으로 나타낼 수 있으면 해결할 수 있다.</p>\n</li>\n<li>\n<p>PCA는 고차원의 데이터를 principal components을 이용해 저차원의 데이터로 나타내는 방법이다. 첫 번째 principal components <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">Z_{1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>은 아래 문제를 풀면 얻을 수 있다. <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϕ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\phi_{1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>은 loading vector라 하고, 데이터의 분산이 가장 큰 방향을 결정한다.</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mi>i</mi><mi>m</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy=\"false\">(</mo><msub><mi>ϕ</mi><mn>11</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><msub><mi>ϕ</mi><mrow><mi>p</mi><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">{</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><msubsup><mi mathvariant=\"normal\">Σ</mi><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mo stretchy=\"false\">(</mo><msubsup><mi mathvariant=\"normal\">Σ</mi><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></msubsup><msub><mi>ϕ</mi><mrow><mi>j</mi><mn>1</mn></mrow></msub><msubsup><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">}</mo><mtext> </mtext><mi>s</mi><mi>u</mi><mi>b</mi><mi>j</mi><mi>e</mi><mi>c</mi><mi>t</mi><mtext> </mtext><mi>t</mi><mi>o</mi><msubsup><mi mathvariant=\"normal\">Σ</mi><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></msubsup><msubsup><mi>ϕ</mi><mrow><mi>j</mi><mn>1</mn></mrow><mn>2</mn></msubsup><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">maximize(\\phi_{11},...,\\phi_{p1})\\{ \\frac{1}{n}\\Sigma^{n}_{i=1}(\\Sigma^{p}_{j=1}\\phi_{j1}x_{ij}^2)^2 \\} \\ subject\\ to \\Sigma^{p}_{j=1}\\phi_{j1}^2=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">imi</span><span class=\"mord mathnormal\">ze</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">...</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mopen\">{</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord\">Σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\">Σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7823em;\"><span style=\"top:-2.4231em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.1809em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.413em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3831em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">}</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">bj</span><span class=\"mord mathnormal\">ec</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">o</span><span class=\"mord\"><span class=\"mord\">Σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7823em;\"><span style=\"top:-2.4231em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.1809em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.413em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3831em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span></div>\n<p>n 번째 principal component <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">Z_{n}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>도 위 식을 통해 얻을 수 있는데 이때 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Z_{n-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span></span>와 상관관계가 없어야 한다. 그러면 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">Z_{n}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>의 loading vector <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϕ</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\phi_{n}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>는 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\phi_{n-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9028em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span></span>와 직교하게 된다.</p>\n</li>\n<li>\n<p>상관관계가 높은 변수들의 정보가 하나의 principal component으로 합쳐질 수 있기 때문에 데이터를 저차원으로 축소해도 데이터가 가지고 있는 정보를 잃지 않을 수 있다. 그리고 이렇게 얻은 principal components을 기준으로 시각화하게 되면 데이터를 한눈에 이해하기 쉽다는 장점이 있다.</p>\n</li>\n</ul>\n<h3>10.2.2 Another Interpretation of Principal Components</h3>\n<ul>\n<li>첫 번째 principal component는 특별한 특징을 가지고 있는데, 이 principal component는 n개의 데이터들과 가장 거리가 가까운 선이다. 즉, 데이터를 가장 잘 설명할 수 있는 1차원(선)이라고 할 수 있다.</li>\n<li>그리고 이는 계속 확장되어 M개의 principal component는 데이터를 가장 잘 설명할 수 있는 M차원이고, M이 충분히 크면 데이터의 좋은 근사치이다.</li>\n</ul>\n<h3>10.2.3 More on PCA</h3>\n<p><strong>Scaling the Variables</strong></p>\n<ul>\n<li>Principal component는 데이터의 분산이 가장 큰 방향으로 정의되기 때문에 특정 <em>X</em>의 분산이 상대적으로 크다면 결과가 치우쳐질 수 있다. 또한, 데이터의 단위에 따라 결과가 달라질 수 있는 문제가 있다. 그렇기 때문에 PCA를 하기 전에 표준편차가 1이 될 수 있도록 표준화하는 게 중요하다.</li>\n<li>만약 모든 <em>X</em>가 동일한 단위로 측정된 데이터라면 굳이 표준화를 할 필요가 없을 수도 있다.</li>\n</ul>\n<p><strong>Uniqueness of the Principal Components</strong></p>\n<ul>\n<li>Principal component Z는 -Z와 같다. 음수라고 해도 절댓값이 같다면 같은 principal component이다.</li>\n</ul>\n<p><strong>The Proportion of Variance Explained</strong></p>\n<ul>\n<li>\n<p>Proportion of variance explained(PVE)는 전체 데이터의 분산 대비 principal component로 인해 얼마만큼의 분산이 설명되고 있는지를 수치적으로 나타내준다. M번째 principal component의 PVE는 다음과 같다.</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><mi>V</mi><mi>E</mi><mo>=</mo><mfrac><mrow><msubsup><mi mathvariant=\"normal\">Σ</mi><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mo stretchy=\"false\">(</mo><msubsup><mi mathvariant=\"normal\">Σ</mi><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></msubsup><msub><mi>ϕ</mi><mrow><mi>j</mi><mi>m</mi></mrow></msub><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><mrow><msubsup><mi mathvariant=\"normal\">Σ</mi><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></msubsup><msubsup><mi mathvariant=\"normal\">Σ</mi><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">PVE=\\frac{\\Sigma^{n}_{i=1}(\\Sigma^{p}_{j=1}\\phi_{jm}x_{ij})^2}{\\Sigma^{p}_{j=1}\\Sigma^{n}_{i=1}x_{ij}^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.7161em;vertical-align:-1.099em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6171em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">Σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7823em;\"><span style=\"top:-2.4231em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.1809em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.413em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\">Σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6462em;\"><span style=\"top:-2.4231em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.0448em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2769em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7959em;\"><span style=\"top:-2.4231em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span><span style=\"top:-3.0448em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.413em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.803em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">Σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2587em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\">Σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7823em;\"><span style=\"top:-2.4231em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.1809em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.413em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">jm</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.099em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></div>\n</li>\n</ul>\n<p><strong>Deciding How Many Principal Components to Use</strong></p>\n<ul>\n<li>N x p <em>X</em>에서 principal component는 min(n-1, p)개 얻을 수 있다. 하지만 보통 우리는 데이터를 잘 이해하기에 충분한 최소한의 principal component를 사용하고 싶다.</li>\n<li>Principal component 개수에 따른 누적 PVE를 보여주는 scree plot을 이용하면 의사결정에 도움이 될 수 있다. Principal component를 추가로 이용했을 때 누적 PVE의 상승 폭이 줄어드는 지점, 즉 elbow point를 기준으로 정하는 것이다.</li>\n<li>하지만, 위 방법은 ad hoc이라는 점에서 한계를 가진다. 또한, 어떤 데이터인지, 분석의 목적이 무엇인지에 따라 결론이 달라질 수 있다.</li>\n<li>보통은 처음 몇 개의 principal component를 살펴보고 흥미로운 지점들이 있으면 추가적으로 principal component를 계산하고, 만약 없다면 중단하는 방법으로 사용된다.</li>\n<li>반대로 만약 principal component를 supervised learning 문제에서 사용한다면, 몇 개의 component를 사용하는 게 하나의 parameter가 될 수 있고 이는 cross validation 등의 방법으로 정할 수 있다.</li>\n</ul>\n<h3>10.2.4 Other Uses for Principal Components</h3>\n<ul>\n<li>데이터의 signal이 처음 몇 개의 principal component에 집중될 수 있기 때문에 p개의 모든 <em>X</em>를 사용하기보단 M개의 principal component를 이용해 regression, classification 또는 clustering 문제를 풀 수 있다.</li>\n</ul>\n<h2>10.3 Clustering Methods</h2>\n<ul>\n<li>Clustering은 데이터를 하위 그룹 또는 cluster로 나누는 방법이다. 이때, 같은 cluster 내의 데이터는 최대한 비슷하고 다른 cluster끼리는 최대한 달라야 한다. 두 개 이상의 데이터가 비슷하다, 다르다는 건 도메인에 따라 다르게 정의될 수 있기 때문에 데이터에 대한 지식을 바탕으로 분석을 하는 게 좋다.</li>\n<li>PCA와 clustering의 목표는 데이터를 단순화시켜 이해하는 것으로 같다. 하지만, 접근 방식에서 차이가 나는데 PCA는 데이터의 분산을 잘 설명할 수 있도록 데이터를 저차원으로 나타내고자 하는 반면 clustering은 데이터를 비슷한 것끼리 하위 그룹으로 나누는 방법을 취한다.</li>\n<li>데이터를 clustering하는 방법으로 feature도 clustering 할 수 있다.</li>\n</ul>\n<h3>10.3.1 K-Means Clustering</h3>\n<ul>\n<li>K-means clustering을 하기 위해서는 먼저 몇 개의 cluster로 데이터를 나눌 건지를 나타내는 K값을 정의해야 한다. 그리고 K-means 알고리즘을 이용해 각 데이터를 K개의 그룹 중 하나로 분류하면 된다.</li>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><msub><mi>C</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">C_{1}, ..., C_{k}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">...</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>를 각 cluster에 속한 데이터라고 하자, cluster는 다음의 두 가지 특징을 만족해야 한다.\n<ol>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mn>1</mn></msub><mo>∪</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo>∪</mo><msub><mi>C</mi><mi>k</mi></msub><mo>=</mo><mo stretchy=\"false\">{</mo><mn>1</mn><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><mi>n</mi><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">C_{1}\\cup...\\cup C_{k}=\\{1,...,n\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∪</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5556em;\"></span><span class=\"mord\">...</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∪</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">...</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">}</span></span></span></span></span>. 하나의 데이터는 최소 한 개 이상의 cluster에 속해야 한다.</li>\n<li>모든 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo mathvariant=\"normal\">≠</mo><msup><mi>k</mi><msup><mrow></mrow><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></msup></mrow><annotation encoding=\"application/x-tex\">k \\neq k^{'}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9425em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9425em;\"><span style=\"top:-2.9425em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.5795em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8278em;\"><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>에 대해 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mi>k</mi></msub><mo>∩</mo><msub><mi>C</mi><msup><mi>k</mi><msup><mrow></mrow><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></msup></msub><mo>=</mo><mi>ϕ</mi></mrow><annotation encoding=\"application/x-tex\">C_{k}\\cap C_{k^{'}}=\\phi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∩</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9635em;vertical-align:-0.2802em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.4198em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8928em;\"><span style=\"top:-2.8928em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.6068em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8496em;\"><span style=\"top:-2.8496em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.5556em;\"></span><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2802em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ϕ</span></span></span></span></span>이다. Cluster들은 중복되지 않는다. 즉, 모든 데이터는 하나의 cluster에만 속한다.</li>\n</ol>\n</li>\n<li>K-means cluster는 within-cluster variation이 가장 작은 cluster를 좋다고 정의한다. <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">C_{k}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span> cluster에서 within-cluster variation은 하나의 데이터가 다른 데이터들과 얼마나 다른지를 나타낸 값으로 Euclidean distance의 제곱 값으로 나타낸다.</li>\n<li>모든 경우의 수를 고려하며 위 문제를 풀기에는 계산량이 너무 많기 때문에 k-means는 간단한 알고리즘을 활용한다.\n<ol>\n<li>랜덤으로 각 데이터를 K개의 cluster 중 하나에 포함시킨다.</li>\n<li>Clustering 결과가 달라질 때까지 (a) - (b)를 반복한다.\n<ol>\n<li>각 cluster의 중심점을 계산한다.</li>\n<li>모든 중심점까지의 거리를 계산하고 거리가 가장 가까운 중심점이 속한 cluster에 포함시킨다.</li>\n</ol>\n</li>\n</ol>\n</li>\n<li>K-means로 얻은 결과는 첫 번째 단계의 랜덤화 과정에서 달라져 local optimum일 가능성이 크다. 따라서, 위 과정을 여러 번 반복하고 within-cluster variation의 합이 가장 작은 결과를 사용하는 게 좋다.</li>\n</ul>\n<h3>10.3.2 Hierarchical Clustering</h3>\n<ul>\n<li>Hierarchical clustering은 k-means와 달리 K값을 미리 정하지 않고, 결과를 dendrogram으로 시각화할 수 있다는 장점을 가진다.</li>\n<li>이 장에서는 hierarchical clustering을 하는 방법 중 가장 많이 사용되는 bottom-up 또는 agglomerative을 살펴볼 것이다. Bottom-up 방법을 사용하면 dendrogram은 하나의 데이터 또는 leave로 시작해 군집화되어 trunks가 된다.</li>\n</ul>\n<p><strong>Interpreting a Dendrogram</strong></p>\n<ul>\n<li>Hierarchical clustering에서 데이터는 비슷할수록 빨리 합쳐진다. 즉, 데이터가 언제 합쳐지는 냐에 따라 얼마나 비슷한지 알 수 있다.</li>\n<li>주의해야 할 점이 있다면 dendrogram에서 두 데이터가 합쳐지는 높이가 비슷한 두 개의 쌍이 있을 때 각 cluster 내에서 데이터끼리의 비슷함 정도가 똑같다는 의미는 아니다.</li>\n<li>데이터를 cluster로 나누기 위해서는 dendrogram을 수평으로 자르면 된다. 어디서 자르는지에 따라 cluster의 개수가 정해진다.</li>\n<li>한 번의 분석으로 다양한 cluster 개수를 탐구할 수 있다는 장점이 있기는 하지만 많은 경우에 cluster 숫자를 정하는 작업은 명확하지 않다.</li>\n<li>Hierarchical라는 명칭은 dendrogram을 수평으로 잘랐을 때 하나의 cluster 안에 여러 개의 cluster가 속할 수 있기 때문에 붙여졌다.</li>\n<li>하지만, 만약 데이터가 어떠한 조건에 의해 명확하게 분류될 수 있다면 hierarchical 방법은 k-means 보다 결과가 안 좋을 가능성이 크다.</li>\n</ul>\n<p><strong>The Hierarchical Clustering Algorithm</strong></p>\n<ul>\n<li>Hierarchical clustering을 하기 위해서는 가장 먼저 데이터의 거리를 어떻게 층정할 건지 정의해야 한다. 주로 Euclidean distance이 사용된다. Dendrogram의 가장 밑에부터 시작하면, 각각의 데이터를 하나의 cluster로 여기고 cluster끼리의 거리를 계산한다. 거리가 가장 가까운 두 개의 cluster를 합친다. 이 과정을 하나의 cluster가 남을 때까지 반복하면 된다.</li>\n<li>Cluster와 cluster끼리의 거리를 계산하기 위해서는 linkage라는 개념이 사용된다. 대표적으로 complete, average, single, centroid 방법이 있는데 average와 complete이 가장 많이 사용된다.\n<ul>\n<li>Complete는 A cluster 데이터와 B cluster 데이터의 모든 쌍의 거리를 측정하고, 가장 큰 값을 사용한다.</li>\n<li>Single은 A cluster 데이터와 B cluster 데이터의 모든 쌍의 거리를 측정하고, 가장 작은 값을 사용한다.</li>\n<li>Average은 A cluster 데이터와 B cluster 데이터의 모든 쌍의 거리를 측정하고, 평균 값을 사용한다.</li>\n<li>Centroid은 A cluster의 중심점과 B cluster의 중심점의 거리 값을 사용한다.</li>\n</ul>\n</li>\n<li>어떠한 linkage 방법을 사용하는지, 그리고 두 데이터의 거리를 어떻게 측정하는지에 따라 clustering 결과가 달라진다.</li>\n</ul>\n<p><strong>Choice of Dissimilarity Measure</strong></p>\n<ul>\n<li>어떠한 도메인 데이터인지, 무슨 문제를 푸는지에 따라 Euclidean distance 말고 다른 지표를 사용하는 게 나을 수 있다.</li>\n<li>또한, 표준편차가 1이 되도록 데이터를 표준화하는 게 결과에 더 좋을 수 있다.</li>\n</ul>\n<h3>10.3.3 Practical Issues in Clustering</h3>\n<p><strong>Small Decisions with Big Consequences</strong></p>\n<ul>\n<li>Clustering 하기 전에는 아래와 같은 점들을 먼저 고려해야 한다.\n<ul>\n<li>데이터를 표준화해야 할까?</li>\n<li>Hierarchical clustering을 한다면, cluster끼리 거리는 어떻게 측정할까? 어떤 linkage 방법을 사용할까? Dendrogram의 어느 부분에서 잘라야 할까?</li>\n<li>K-means clustering을 한다면, 데이터를 몇 개의 cluster로 나눠야 할까?</li>\n</ul>\n</li>\n<li>위의 결정에 따라 결과가 크게 달라질 수 있는데 정답은 없다는 게 clustering의 단점이다. 가장 좋은 방법은 여러 가지 경우의 수를 적용해 보고 데이터를 가장 잘 설명하는 선택지를 고르는 것이다.</li>\n</ul>\n<p><strong>Validating the Clusters Obtained</strong></p>\n<ul>\n<li>Clustering으로 얻은 결과가 데이터를 제대로 분류하는지 알고 싶지만 이는 쉽게 대답하기 어렵다.</li>\n<li>여러 연구 결과가 있기는 하지만 어떤 방법이 가장 좋은지에 대한 명확한 답은 없는 상황이다.</li>\n</ul>\n<p><strong>Other Considerations in Clustering</strong></p>\n<ul>\n<li>K-means와 hierarchical clustering은 데이터를 하나의 cluster에만 속하도록 하는데, 실제로 데이터가 여러 개의 그룹에 속하거나 어떠한 그룹에도 속하지 않은 데이터가 있는 경우 clustering의 결과가 잘 못 될 수 있다. 이런 데이터에서는 mixture models을 사용하면 좋을 수도 있다.</li>\n<li>또한, clustering은 데이터가 조금이라도 변하면 결과가 달라진다는 문제가 있기도 하다.</li>\n</ul>\n<p><strong>A Tempered Approach to Interpreting the Results of Clustering</strong></p>\n<ul>\n<li>여러 가지 문제 및 고려해야 할 점들이 있기는 하지만 잘 사용한다면 clustering은 데이터를 이해하는 좋은 방법이 될 수 있다.</li>\n<li>가장 좋은 방법은 다양한 parameter에 대해 clustering을 해보고 데이터에 어떠한 패턴이 있는지 전체적으로 살펴보는 것이다.</li>\n<li>어떤 데이터를 사용하는지에 따라 결과가 달라질 가능성이 크기 때문에 데이터를 나눠서 clustering 해 보는 방법도 추천한다.</li>\n<li>가장 중요한 것은 clustering 결과를 데이터에 대한 무조건적인 진실을 얘기한다는 식으로 전달해서는 안 된다는 것이다. 오히려 데이터를 더 깊이 탐구하기 전 시작점으로 생각하는 게 좋다.</li>\n</ul>","frontmatter":{"title":"Ch 10. Unsupervised Learning","date":"January 31, 2022","description":"Introduction to Statistical Learning Chapter 10 Notes","category":null,"tags":["ISL"]}},"previous":{"fields":{"slug":"/isl/ch9/"},"frontmatter":{"title":"Ch 9. Support Vector Machines"}},"next":{"fields":{"slug":"/data-analysis/plot_cohort_chart_using_python/"},"frontmatter":{"title":"Python으로 그려보는 Cohort Chart"}}},"pageContext":{"id":"e24f9e4f-205c-5eaa-8ad5-4393a9b53a91","previousPostId":"a593d785-ec01-57e0-8ba5-09bee4026300","nextPostId":"0f2ec019-92b9-5452-8b07-bc01851d3336"}},
    "staticQueryHashes": ["2841359383"]}